{"STAGE DEPENDENCIES":{"Stage-1":{"ROOT STAGE":"TRUE"},"Stage-0":{"DEPENDENT STAGES":"Stage-1"}},"STAGE PLANS":{"Stage-1":{"Tez":{"DagId:":"wentingt_20180309135527_4b5bf7b0-35fa-4beb-9e91-4a9817d52c67:1","Edges:":{"Reducer 2":[{"parent":"Map 1","type":"SIMPLE_EDGE"},{"parent":"Map 5","type":"SIMPLE_EDGE"}],"Reducer 3":[{"parent":"Map 6","type":"SIMPLE_EDGE"},{"parent":"Reducer 2","type":"SIMPLE_EDGE"},{"parent":"Reducer 9","type":"SIMPLE_EDGE"}],"Reducer 4":{"parent":"Reducer 3","type":"SIMPLE_EDGE"},"Reducer 8":[{"parent":"Map 10","type":"SIMPLE_EDGE"},{"parent":"Map 7","type":"SIMPLE_EDGE"}],"Reducer 9":{"parent":"Reducer 8","type":"SIMPLE_EDGE"}},"DagName:":"","Vertices:":{"Map 1":{"Map Operator Tree:":[{"TableScan":{"alias:":"cs","Statistics:":"Num rows: 71637279 Data size: 9722554208 Basic stats: COMPLETE Column stats: NONE","children":{"Filter Operator":{"predicate:":"cs_item_sk is not null (type: boolean)","Statistics:":"Num rows: 71637279 Data size: 9722554208 Basic stats: COMPLETE Column stats: NONE","children":{"Select Operator":{"expressions:":"cs_item_sk (type: int), cs_ext_discount_amt (type: float), cs_sold_date_sk (type: int)","outputColumnNames:":["_col0","_col1","_col2"],"Statistics:":"Num rows: 71637279 Data size: 9722554208 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"_col2 (type: int)","sort order:":"+","Map-reduce partition columns:":"_col2 (type: int)","Statistics:":"Num rows: 71637279 Data size: 9722554208 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col0 (type: int), _col1 (type: float)"}}}}}}}}]},"Map 10":{"Map Operator Tree:":[{"TableScan":{"alias:":"d","Statistics:":"Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE","children":{"Filter Operator":{"predicate:":"(d_date_sk is not null and d_date BETWEEN '2000-01-27' AND '2000-04-27') (type: boolean)","Statistics:":"Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE","children":{"Select Operator":{"expressions:":"d_date_sk (type: int)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE","children":[{"Reduce Output Operator":{"key expressions:":"_col0 (type: int)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: int)","Statistics:":"Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE"}},{"Select Operator":{"expressions:":"_col0 (type: int)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE","children":{"Group By Operator":{"keys:":"_col0 (type: int)","mode:":"hash","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE","children":{"Dynamic Partitioning Event Operator":{"Target column:":"cs_sold_date_sk (int)","Target Input:":"cs","Partition key expr:":"cs_sold_date_sk","Statistics:":"Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE","Target Vertex:":"Map 7"}}}}}}]}}}}}}]},"Map 5":{"Map Operator Tree:":[{"TableScan":{"alias:":"d","Statistics:":"Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE","children":{"Filter Operator":{"predicate:":"(d_date_sk is not null and d_date BETWEEN '2000-01-27' AND '2000-04-27') (type: boolean)","Statistics:":"Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE","children":{"Select Operator":{"expressions:":"d_date_sk (type: int)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE","children":[{"Reduce Output Operator":{"key expressions:":"_col0 (type: int)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: int)","Statistics:":"Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE"}},{"Select Operator":{"expressions:":"_col0 (type: int)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE","children":{"Group By Operator":{"keys:":"_col0 (type: int)","mode:":"hash","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE","children":{"Dynamic Partitioning Event Operator":{"Target column:":"cs_sold_date_sk (int)","Target Input:":"cs","Partition key expr:":"cs_sold_date_sk","Statistics:":"Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE","Target Vertex:":"Map 1"}}}}}}]}}}}}}]},"Map 6":{"Map Operator Tree:":[{"TableScan":{"alias:":"i","Statistics:":"Num rows: 62000 Data size: 88903588 Basic stats: COMPLETE Column stats: NONE","children":{"Filter Operator":{"predicate:":"(i_item_sk is not null and (i_manufact_id = 436)) (type: boolean)","Statistics:":"Num rows: 31000 Data size: 44451794 Basic stats: COMPLETE Column stats: NONE","children":{"Select Operator":{"expressions:":"i_item_sk (type: int)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 31000 Data size: 44451794 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"_col0 (type: int)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: int)","Statistics:":"Num rows: 31000 Data size: 44451794 Basic stats: COMPLETE Column stats: NONE"}}}}}}}}]},"Map 7":{"Map Operator Tree:":[{"TableScan":{"alias:":"cs","Statistics:":"Num rows: 71637279 Data size: 9722554208 Basic stats: COMPLETE Column stats: NONE","children":{"Filter Operator":{"predicate:":"cs_item_sk is not null (type: boolean)","Statistics:":"Num rows: 71637279 Data size: 9722554208 Basic stats: COMPLETE Column stats: NONE","children":{"Select Operator":{"expressions:":"cs_item_sk (type: int), cs_ext_discount_amt (type: float), cs_sold_date_sk (type: int)","outputColumnNames:":["_col0","_col1","_col2"],"Statistics:":"Num rows: 71637279 Data size: 9722554208 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"_col2 (type: int)","sort order:":"+","Map-reduce partition columns:":"_col2 (type: int)","Statistics:":"Num rows: 71637279 Data size: 9722554208 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col0 (type: int), _col1 (type: float)"}}}}}}}}]},"Reducer 2":{"Reduce Operator Tree:":{"Merge Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"}],"keys:":{"0":"_col2 (type: int)","1":"_col0 (type: int)"},"outputColumnNames:":["_col0","_col1"],"Statistics:":"Num rows: 78801008 Data size: 10694809860 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"_col0 (type: int)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: int)","Statistics:":"Num rows: 78801008 Data size: 10694809860 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col1 (type: float)"}}}}},"Reducer 3":{"Reduce Operator Tree:":{"Merge Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"},{"":"Inner Join 1 to 2"}],"keys:":{"0":"_col0 (type: int)","1":"_col0 (type: int)","2":"_col0 (type: int)"},"outputColumnNames:":["_col1","_col5"],"Statistics:":"Num rows: 173362221 Data size: 23528582201 Basic stats: COMPLETE Column stats: NONE","children":{"Filter Operator":{"predicate:":"(UDFToDouble(_col1) > _col5) (type: boolean)","Statistics:":"Num rows: 57787407 Data size: 7842860733 Basic stats: COMPLETE Column stats: NONE","children":{"Select Operator":{"expressions:":"_col1 (type: float)","outputColumnNames:":["_col1"],"Statistics:":"Num rows: 57787407 Data size: 7842860733 Basic stats: COMPLETE Column stats: NONE","children":{"Group By Operator":{"aggregations:":["sum(_col1)"],"mode:":"hash","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"sort order:":"","Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col0 (type: double)"}}}}}}}}}}},"Reducer 4":{"Reduce Operator Tree:":{"Group By Operator":{"aggregations:":["sum(VALUE._col0)"],"mode:":"mergepartial","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","children":{"File Output Operator":{"compressed:":"false","Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","table:":{"input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat","serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"}}}}}},"Reducer 8":{"Reduce Operator Tree:":{"Merge Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"}],"keys:":{"0":"_col2 (type: int)","1":"_col0 (type: int)"},"outputColumnNames:":["_col0","_col1"],"Statistics:":"Num rows: 78801008 Data size: 10694809860 Basic stats: COMPLETE Column stats: NONE","children":{"Group By Operator":{"aggregations:":["avg(_col1)"],"keys:":"_col0 (type: int)","mode:":"hash","outputColumnNames:":["_col0","_col1"],"Statistics:":"Num rows: 78801008 Data size: 10694809860 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"_col0 (type: int)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: int)","Statistics:":"Num rows: 78801008 Data size: 10694809860 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col1 (type: struct<count:bigint,sum:double,input:float>)"}}}}}}},"Reducer 9":{"Reduce Operator Tree:":{"Group By Operator":{"aggregations:":["avg(VALUE._col0)"],"keys:":"KEY._col0 (type: int)","mode:":"mergepartial","outputColumnNames:":["_col0","_col1"],"Statistics:":"Num rows: 39400504 Data size: 5347404930 Basic stats: COMPLETE Column stats: NONE","children":{"Select Operator":{"expressions:":"_col0 (type: int), (1.3 * _col1) (type: double)","outputColumnNames:":["_col0","_col1"],"Statistics:":"Num rows: 39400504 Data size: 5347404930 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"_col0 (type: int)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: int)","Statistics:":"Num rows: 39400504 Data size: 5347404930 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col1 (type: double)"}}}}}}}}}},"Stage-0":{"Fetch Operator":{"limit:":"-1","Processor Tree:":{"ListSink":{}}}}}}
