{"STAGE DEPENDENCIES":{"Stage-1":{"ROOT STAGE":"TRUE"},"Stage-0":{"DEPENDENT STAGES":"Stage-1"}},"STAGE PLANS":{"Stage-1":{"Tez":{"DagId:":"wentingt_20180309153935_a97abf50-e3e7-4076-bf12-0e367c92444e:1","Edges:":{"Reducer 2":[{"parent":"Map 1","type":"SIMPLE_EDGE"},{"parent":"Map 10","type":"BROADCAST_EDGE"},{"parent":"Map 9","type":"SIMPLE_EDGE"}],"Reducer 3":[{"parent":"Map 11","type":"SIMPLE_EDGE"},{"parent":"Reducer 2","type":"SIMPLE_EDGE"}],"Reducer 4":[{"parent":"Map 12","type":"SIMPLE_EDGE"},{"parent":"Reducer 3","type":"SIMPLE_EDGE"}],"Reducer 5":[{"parent":"Map 13","type":"SIMPLE_EDGE"},{"parent":"Reducer 4","type":"SIMPLE_EDGE"}],"Reducer 6":[{"parent":"Map 14","type":"SIMPLE_EDGE"},{"parent":"Map 15","type":"BROADCAST_EDGE"},{"parent":"Reducer 5","type":"SIMPLE_EDGE"}],"Reducer 7":{"parent":"Reducer 6","type":"SIMPLE_EDGE"},"Reducer 8":{"parent":"Reducer 7","type":"SIMPLE_EDGE"}},"DagName:":"","Vertices:":{"Map 1":{"Map Operator Tree:":[{"TableScan":{"alias:":"web_sales","Statistics:":"Num rows: 14392539 Data size: 1957185968 Basic stats: COMPLETE Column stats: NONE","children":{"Filter Operator":{"predicate:":"((ws_item_sk is not null and ws_order_number is not null) and ws_web_page_sk is not null) (type: boolean)","Statistics:":"Num rows: 14392539 Data size: 1957185968 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"ws_item_sk (type: int), ws_order_number (type: bigint)","sort order:":"++","Map-reduce partition columns:":"ws_item_sk (type: int), ws_order_number (type: bigint)","Statistics:":"Num rows: 14392539 Data size: 1957185968 Basic stats: COMPLETE Column stats: NONE","value expressions:":"ws_web_page_sk (type: int), ws_quantity (type: int), ws_sales_price (type: float), ws_net_profit (type: float), ws_sold_date_sk (type: int)"}}}}}}]},"Map 10":{"Map Operator Tree:":[{"TableScan":{"alias:":"web_page","Statistics:":"Num rows: 264 Data size: 154680 Basic stats: COMPLETE Column stats: NONE","children":{"Filter Operator":{"predicate:":"wp_web_page_sk is not null (type: boolean)","Statistics:":"Num rows: 264 Data size: 154680 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"wp_web_page_sk (type: int)","sort order:":"+","Map-reduce partition columns:":"wp_web_page_sk (type: int)","Statistics:":"Num rows: 264 Data size: 154680 Basic stats: COMPLETE Column stats: NONE"}}}}}}]},"Map 11":{"Map Operator Tree:":[{"TableScan":{"alias:":"cd1","Statistics:":"Num rows: 1920800 Data size: 718379200 Basic stats: COMPLETE Column stats: NONE","children":{"Filter Operator":{"predicate:":"cd_demo_sk is not null (type: boolean)","Statistics:":"Num rows: 1920800 Data size: 718379200 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"cd_demo_sk (type: int)","sort order:":"+","Map-reduce partition columns:":"cd_demo_sk (type: int)","Statistics:":"Num rows: 1920800 Data size: 718379200 Basic stats: COMPLETE Column stats: NONE","value expressions:":"cd_marital_status (type: string), cd_education_status (type: string)"}}}}}}]},"Map 12":{"Map Operator Tree:":[{"TableScan":{"alias:":"cd2","Statistics:":"Num rows: 1920800 Data size: 718379200 Basic stats: COMPLETE Column stats: NONE","children":{"Filter Operator":{"predicate:":"cd_demo_sk is not null (type: boolean)","Statistics:":"Num rows: 1920800 Data size: 718379200 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"cd_demo_sk (type: int)","sort order:":"+","Map-reduce partition columns:":"cd_demo_sk (type: int)","Statistics:":"Num rows: 1920800 Data size: 718379200 Basic stats: COMPLETE Column stats: NONE","value expressions:":"cd_marital_status (type: string), cd_education_status (type: string)"}}}}}}]},"Map 13":{"Map Operator Tree:":[{"TableScan":{"alias:":"customer_address","Statistics:":"Num rows: 133000 Data size: 134978904 Basic stats: COMPLETE Column stats: NONE","children":{"Filter Operator":{"predicate:":"ca_address_sk is not null (type: boolean)","Statistics:":"Num rows: 133000 Data size: 134978904 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"ca_address_sk (type: int)","sort order:":"+","Map-reduce partition columns:":"ca_address_sk (type: int)","Statistics:":"Num rows: 133000 Data size: 134978904 Basic stats: COMPLETE Column stats: NONE","value expressions:":"ca_state (type: string), ca_country (type: string)"}}}}}}]},"Map 14":{"Map Operator Tree:":[{"TableScan":{"alias:":"date_dim","Statistics:":"Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE","children":{"Filter Operator":{"predicate:":"(d_date_sk is not null and (d_year = 1998)) (type: boolean)","Statistics:":"Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE","children":[{"Reduce Output Operator":{"key expressions:":"d_date_sk (type: int)","sort order:":"+","Map-reduce partition columns:":"d_date_sk (type: int)","Statistics:":"Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE"}},{"Select Operator":{"expressions:":"d_date_sk (type: int)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE","children":{"Group By Operator":{"keys:":"_col0 (type: int)","mode:":"hash","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE","children":{"Dynamic Partitioning Event Operator":{"Target column:":"ws_sold_date_sk (int)","Target Input:":"web_sales","Partition key expr:":"ws_sold_date_sk","Statistics:":"Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE","Target Vertex:":"Map 1"}}}}}}]}}}}]},"Map 15":{"Map Operator Tree:":[{"TableScan":{"alias:":"reason","Statistics:":"Num rows: 36 Data size: 7344 Basic stats: COMPLETE Column stats: NONE","children":{"Filter Operator":{"predicate:":"r_reason_sk is not null (type: boolean)","Statistics:":"Num rows: 36 Data size: 7344 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"r_reason_sk (type: int)","sort order:":"+","Map-reduce partition columns:":"r_reason_sk (type: int)","Statistics:":"Num rows: 36 Data size: 7344 Basic stats: COMPLETE Column stats: NONE","value expressions:":"r_reason_desc (type: string)"}}}}}}]},"Map 9":{"Map Operator Tree:":[{"TableScan":{"alias:":"web_returns","Statistics:":"Num rows: 1439266 Data size: 132728800 Basic stats: COMPLETE Column stats: NONE","children":{"Filter Operator":{"predicate:":"(((((wr_item_sk is not null and wr_order_number is not null) and wr_refunded_cdemo_sk is not null) and wr_returning_cdemo_sk is not null) and wr_refunded_addr_sk is not null) and wr_reason_sk is not null) (type: boolean)","Statistics:":"Num rows: 1439266 Data size: 132728800 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"wr_item_sk (type: int), wr_order_number (type: bigint)","sort order:":"++","Map-reduce partition columns:":"wr_item_sk (type: int), wr_order_number (type: bigint)","Statistics:":"Num rows: 1439266 Data size: 132728800 Basic stats: COMPLETE Column stats: NONE","value expressions:":"wr_refunded_cdemo_sk (type: int), wr_refunded_addr_sk (type: int), wr_returning_cdemo_sk (type: int), wr_reason_sk (type: int), wr_fee (type: float), wr_refunded_cash (type: float)"}}}}}}]},"Reducer 2":{"Reduce Operator Tree:":{"Merge Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"}],"keys:":{"0":"ws_item_sk (type: int), ws_order_number (type: bigint)","1":"wr_item_sk (type: int), wr_order_number (type: bigint)"},"outputColumnNames:":["_col2","_col11","_col16","_col17","_col20","_col32","_col33","_col38","_col40","_col42","_col44","_col48","_col49","_col54","_col56"],"Statistics:":"Num rows: 15831793 Data size: 2152904611 Basic stats: COMPLETE Column stats: NONE","children":{"Map Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"}],"keys:":{"0":"_col11 (type: int)","1":"wp_web_page_sk (type: int)"},"outputColumnNames:":["_col2","_col11","_col16","_col17","_col20","_col32","_col33","_col38","_col40","_col42","_col44","_col48","_col49","_col54","_col56","_col64"],"input vertices:":{"1":"Map 10"},"Statistics:":"Num rows: 17414972 Data size: 2368195123 Basic stats: COMPLETE Column stats: NONE","HybridGraceHashJoin:":"true","children":{"Reduce Output Operator":{"key expressions:":"_col40 (type: int)","sort order:":"+","Map-reduce partition columns:":"_col40 (type: int)","Statistics:":"Num rows: 17414972 Data size: 2368195123 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col2 (type: int), _col11 (type: int), _col16 (type: bigint), _col17 (type: int), _col20 (type: float), _col32 (type: float), _col33 (type: int), _col38 (type: int), _col42 (type: int), _col44 (type: int), _col48 (type: int), _col49 (type: bigint), _col54 (type: float), _col56 (type: float), _col64 (type: int)"}}}}}}},"Reducer 3":{"Reduce Operator Tree:":{"Merge Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"}],"keys:":{"0":"_col40 (type: int)","1":"cd_demo_sk (type: int)"},"outputColumnNames:":["_col2","_col11","_col16","_col17","_col20","_col32","_col33","_col38","_col40","_col42","_col44","_col48","_col49","_col54","_col56","_col64","_col81","_col83","_col84"],"Statistics:":"Num rows: 19156469 Data size: 2605014691 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"_col44 (type: int)","sort order:":"+","Map-reduce partition columns:":"_col44 (type: int)","Statistics:":"Num rows: 19156469 Data size: 2605014691 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col2 (type: int), _col11 (type: int), _col16 (type: bigint), _col17 (type: int), _col20 (type: float), _col32 (type: float), _col33 (type: int), _col38 (type: int), _col40 (type: int), _col42 (type: int), _col48 (type: int), _col49 (type: bigint), _col54 (type: float), _col56 (type: float), _col64 (type: int), _col81 (type: int), _col83 (type: string), _col84 (type: string)"}}}}},"Reducer 4":{"Reduce Operator Tree:":{"Merge Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"}],"keys:":{"0":"_col44 (type: int)","1":"cd_demo_sk (type: int)"},"outputColumnNames:":["_col2","_col11","_col16","_col17","_col20","_col32","_col33","_col38","_col40","_col42","_col44","_col48","_col49","_col54","_col56","_col64","_col81","_col83","_col84","_col93","_col95","_col96"],"Statistics:":"Num rows: 21072116 Data size: 2865516222 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"_col42 (type: int)","sort order:":"+","Map-reduce partition columns:":"_col42 (type: int)","Statistics:":"Num rows: 21072116 Data size: 2865516222 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col2 (type: int), _col11 (type: int), _col16 (type: bigint), _col17 (type: int), _col20 (type: float), _col32 (type: float), _col33 (type: int), _col38 (type: int), _col40 (type: int), _col44 (type: int), _col48 (type: int), _col49 (type: bigint), _col54 (type: float), _col56 (type: float), _col64 (type: int), _col81 (type: int), _col83 (type: string), _col84 (type: string), _col93 (type: int), _col95 (type: string), _col96 (type: string)"}}}}},"Reducer 5":{"Reduce Operator Tree:":{"Merge Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"}],"keys:":{"0":"_col42 (type: int)","1":"ca_address_sk (type: int)"},"outputColumnNames:":["_col2","_col11","_col16","_col17","_col20","_col32","_col33","_col38","_col40","_col42","_col44","_col48","_col49","_col54","_col56","_col64","_col81","_col83","_col84","_col93","_col95","_col96","_col105","_col113","_col115"],"Statistics:":"Num rows: 23179328 Data size: 3152067912 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"_col33 (type: int)","sort order:":"+","Map-reduce partition columns:":"_col33 (type: int)","Statistics:":"Num rows: 23179328 Data size: 3152067912 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col2 (type: int), _col11 (type: int), _col16 (type: bigint), _col17 (type: int), _col20 (type: float), _col32 (type: float), _col38 (type: int), _col40 (type: int), _col42 (type: int), _col44 (type: int), _col48 (type: int), _col49 (type: bigint), _col54 (type: float), _col56 (type: float), _col64 (type: int), _col81 (type: int), _col83 (type: string), _col84 (type: string), _col93 (type: int), _col95 (type: string), _col96 (type: string), _col105 (type: int), _col113 (type: string), _col115 (type: string)"}}}}},"Reducer 6":{"Reduce Operator Tree:":{"Merge Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"}],"keys:":{"0":"_col33 (type: int)","1":"d_date_sk (type: int)"},"outputColumnNames:":["_col2","_col11","_col16","_col17","_col20","_col32","_col33","_col38","_col40","_col42","_col44","_col48","_col49","_col54","_col56","_col64","_col81","_col83","_col84","_col93","_col95","_col96","_col105","_col113","_col115","_col121"],"Statistics:":"Num rows: 25497261 Data size: 3467274778 Basic stats: COMPLETE Column stats: NONE","children":{"Map Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"}],"keys:":{"0":"_col48 (type: int)","1":"r_reason_sk (type: int)"},"outputColumnNames:":["_col2","_col11","_col16","_col17","_col20","_col32","_col33","_col38","_col40","_col42","_col44","_col48","_col49","_col54","_col56","_col64","_col81","_col83","_col84","_col93","_col95","_col96","_col105","_col113","_col115","_col121","_col152","_col154"],"input vertices:":{"1":"Map 15"},"Statistics:":"Num rows: 28046987 Data size: 3814002338 Basic stats: COMPLETE Column stats: NONE","HybridGraceHashJoin:":"true","children":{"Filter Operator":{"predicate:":"((((((((((_col93 = _col44) and (((_col83 = 'M') and (_col83 = _col95) and (_col84 = '4 yr Degree') and (_col84 = _col96) and _col20 BETWEEN 100.0 AND 150.0) or ((_col83 = 'D') and (_col83 = _col95) and (_col84 = 'Primary') and (_col84 = _col96) and _col20 BETWEEN 50.0 AND 100.0) or ((_col83 = 'U') and (_col83 = _col95) and (_col84 = 'Advanced Degree') and (_col84 = _col96) and _col20 BETWEEN 150.0 AND 200.0))) and (((_col115 = 'United States') and (_col113) IN ('KY', 'GA', 'NM') and _col32 BETWEEN 100 AND 200) or ((_col115 = 'United States') and (_col113) IN ('MT', 'OR', 'IN') and _col32 BETWEEN 150 AND 300) or ((_col115 = 'United States') and (_col113) IN ('WI', 'MO', 'WV') and _col32 BETWEEN 50 AND 250))) and (_col81 = _col40)) and (_col105 = _col42)) and (_col152 = _col48)) and (_col11 = _col64)) and (_col2 = _col38)) and (_col16 = _col49)) and (_col33 = _col121)) (type: boolean)","Statistics:":"Num rows: 3851 Data size: 523682 Basic stats: COMPLETE Column stats: NONE","children":{"Select Operator":{"expressions:":"_col154 (type: string), _col17 (type: int), _col56 (type: float), _col54 (type: float)","outputColumnNames:":["_col154","_col17","_col56","_col54"],"Statistics:":"Num rows: 3851 Data size: 523682 Basic stats: COMPLETE Column stats: NONE","children":{"Group By Operator":{"aggregations:":["avg(_col17)","avg(_col56)","avg(_col54)"],"keys:":"_col154 (type: string)","mode:":"hash","outputColumnNames:":["_col0","_col1","_col2","_col3"],"Statistics:":"Num rows: 3851 Data size: 523682 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"_col0 (type: string)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: string)","Statistics:":"Num rows: 3851 Data size: 523682 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col1 (type: struct<count:bigint,sum:double,input:int>), _col2 (type: struct<count:bigint,sum:double,input:float>), _col3 (type: struct<count:bigint,sum:double,input:float>)"}}}}}}}}}}}}},"Reducer 7":{"Reduce Operator Tree:":{"Group By Operator":{"aggregations:":["avg(VALUE._col0)","avg(VALUE._col1)","avg(VALUE._col2)"],"keys:":"KEY._col0 (type: string)","mode:":"mergepartial","outputColumnNames:":["_col0","_col1","_col2","_col3"],"Statistics:":"Num rows: 1925 Data size: 261773 Basic stats: COMPLETE Column stats: NONE","children":{"Select Operator":{"expressions:":"substr(_col0, 1, 20) (type: string), _col1 (type: double), _col2 (type: double), _col3 (type: double)","outputColumnNames:":["_col0","_col1","_col2","_col3"],"Statistics:":"Num rows: 1925 Data size: 261773 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"_col0 (type: string), _col1 (type: double), _col2 (type: double), _col3 (type: double)","sort order:":"++++","Statistics:":"Num rows: 1925 Data size: 261773 Basic stats: COMPLETE Column stats: NONE","TopN Hash Memory Usage:":"0.1"}}}}}}},"Reducer 8":{"Reduce Operator Tree:":{"Select Operator":{"expressions:":"KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: double), KEY.reducesinkkey2 (type: double), KEY.reducesinkkey3 (type: double)","outputColumnNames:":["_col0","_col1","_col2","_col3"],"Statistics:":"Num rows: 1925 Data size: 261773 Basic stats: COMPLETE Column stats: NONE","children":{"Limit":{"Number of rows:":"100","Statistics:":"Num rows: 100 Data size: 13500 Basic stats: COMPLETE Column stats: NONE","children":{"File Output Operator":{"compressed:":"false","Statistics:":"Num rows: 100 Data size: 13500 Basic stats: COMPLETE Column stats: NONE","table:":{"input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat","serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"}}}}}}}}}}},"Stage-0":{"Fetch Operator":{"limit:":"100","Processor Tree:":{"ListSink":{}}}}}}
